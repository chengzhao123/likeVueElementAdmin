{"code":"webpackHotUpdate(0,{19:function(e,t,o){\"use strict\";var a=o(6),n=o(22),s=o(163),r=o(112);var i=[{path:\"/article\",component:r.a,name:\"Article\",meta:{title:\"文章管理\",icon:\"admin\"},children:[{path:\"list\",component:()=>o.e(4).then(o.bind(null,821)),name:\"Article List\",meta:{title:\"文章列表\",icon:\"admin\"}},{path:\"edit\",component:()=>o.e(3).then(o.bind(null,822)),name:\"Articl Edit\",meta:{title:\"文章管理\",icon:\"admin\",roles:[\"admin\"]}}]},{path:\"/permission\",component:r.a,children:[{path:\"role\",component:()=>o.e(6).then(o.bind(null,823)),name:\"permission Role\",meta:{title:\"角色权限\",icon:\"admin\"}}]}];var c={namespaced:!0,state:{addRoutes:[],routes:[]},mutations:{SET_ROUTES:(e,t)=>{e.addRoutes=t,e.routes=s.a.concat(t)}},actions:{generateRoutes:({commit:e},t)=>new Promise(o=>{let a;a=t.includes(\"admin\")?i||[]:function e(t,o){const a=[];return t.forEach(t=>{const n={...t};(function(e,t){return!t.meta||!t.meta.roles||e.some(e=>t.meta.roles.includes(e))})(o,n)&&(n.children&&(n.children=e(n.children,o)),a.push(n))}),a}(i,t),e(\"SET_ROUTES\",a),o(a)})}},m=o(36),d=o(37),l=o(368),E=o.n(l),u=o(51);const p=E.a.create({baseURL:\"http://localhost:3000\",timeout:5e3});p.interceptors.request.use(e=>(b.getters.token&&(e.headers[\"X-Token\"]=Object(m.a)()),e),e=>Promise.reject(e)),p.interceptors.response.use(e=>{const t=e.data;return 200!==t.code?(Object(u.Message)({message:t.message||\"Error\",type:\"error\",duration:5e3}),500===t.code&&u.MessageBox.confirm(\"登录已失效，请重新登录\",\"提示\",{confirmButtonText:\"重新登录\",cancelButtonText:\"取消\",type:\"warning\"}).then(()=>{b.dispatch(\"user/resetToken\").then(()=>{location.reload()})}),Promise.reject(t.message||\"Error\")):Promise.resolve(t)},e=>(console.log(\"err\"+e),Object(u.Message)({message:e.message,type:\"error\",duration:5e3}),Promise.reject(e)));var T=p;var S={namespaced:!0,state:{token:Object(m.a)(),name:\"\",avatar:\"\",introduction:\"\",roles:[]},mutations:{SET_TOKEN:(e,t)=>{e.token=t},SET_INTRODUCTION:(e,t)=>{e.introduction=t},SET_NAME:(e,t)=>{e.name=t},SET_AVATAR:(e,t)=>{e.avatar=t},SET_ROLES:(e,t)=>{e.roles=t}},actions:{login:({commit:e},t)=>new Promise((o,a)=>{var n;(n=t,T({url:\"/login\",method:\"post\",data:n})).then(t=>{e(\"SET_TOKEN\",t.data.token),Object(m.c)(t.data.token),o(t)}).catch(e=>{a(e)})}),getInfo:({commit:e,state:t})=>new Promise((o,a)=>{t.roles&&t.roles.includes(\"admin\")?e(\"SET_ROLES\",[\"editor\"]):e(\"SET_ROLES\",[\"admin\"]),e(\"SET_NAME\",\"name\"),e(\"SET_AVATAR\",\"avatar\"),e(\"SET_INTRODUCTION\",\"introduction\"),o(t.roles)}),resetToken:({commit:e})=>new Promise(t=>{e(\"SET_TOKEN\",\"\"),e(\"SET_ROLES\",[]),Object(m.b)(),t()}),logout:({commit:e,state:t,dispatch:o})=>new Promise((t,o)=>{e(\"SET_TOKEN\",\"\"),e(\"SET_ROLES\",[]),Object(m.b)(),Object(d.b)(),t()}),async changeRoles({commit:e,dispatch:t},o){const a=o+\"-token\";e(\"SET_ROLES\",o),e(\"SET_TOKEN\",a),Object(m.c)(a),Object(d.b)();const n=await t(\"permission/generateRoutes\",o,{root:!0});d.a.addRoutes(n)}}};var O={namespaced:!0,state:{sidebar:{opened:!0},device:\"pc\"},actions:{toggleSideBar({commit:e}){e(\"TOGGLE_SIDEBAR\")},setSiderBar({commit:e},t){e(\"SET_SIDEBAR\",t)},setDevice({commit:e},t){e(\"SET_DEVICE\",t)}},mutations:{TOGGLE_SIDEBAR:e=>{e.sidebar.opened=!e.sidebar.opened},SET_SIDEBAR:(e,t)=>{e.sidebar.opened=t},SET_DEVICE:(e,t)=>{e.device=t}}};var h={sidebar:e=>e.app.sidebar,device:e=>e.app.device,token:e=>e.user.token,avatar:e=>e.user.avatar,name:e=>e.user.name,introduction:e=>e.user.introduction,roles:e=>e.user.roles,permission_routes:e=>e.permission.routes};a.default.use(n.a);const _=new n.a.Store({modules:{permission:c,user:S,app:O},getters:h});var b=t.a=_}});","extractedComments":[]}